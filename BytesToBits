import gymnasium as gym
from gymnasium import ObservationWrapper
from gymnasium.spaces import Box
import tensorflow as tf
import numpy as np
import statistics
from tensorflow.keras import Model, layers
from tensorflow.keras.layers import Flatten, Dense
import collections
import tqdm
import matplotlib.pyplot as plt

env = gym.make("ALE/Breakout-v5", obs_type="ram")

seed = 21
tf.random.set_seed(seed)
np.random.seed(seed)

class BytesToBits(ObservationWrapper):
    def __init__(self, env):
        super().__init__(env)
        self.observation_space = Box(low=0, high=1, shape=(1024,), dtype=np.uint8)

    def observation(self, obs):
        return np.unpackbits(obs)
    
env = BytesToBits(env)
